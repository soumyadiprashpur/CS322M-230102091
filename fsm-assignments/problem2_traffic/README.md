# Traffic Light FSM with Tick Generator

## Overview
This project implements a **traffic light controller FSM** with a clean separation of:
- **Time-keeping (`tick`)**: generated by a prescaler (divider) from the system clock.  
- **Control logic (FSM)**: controls North-South (NS) and East-West (EW) lights.  

The FSM runs on a fast system clock (50 MHz) but only **advances on tick pulses**.  
For hardware, we use a **1 Hz tick** (1 pulse per second).  
For simulation, we speed up ticks (e.g., 1 pulse every 20 clock cycles) so we don’t wait real time.

---

## Files
- `traffic_light.v` – FSM (green/yellow/red timing 5/2/5/2 seconds).  
- `tick_divider.v` – Prescaler that generates a 1-cycle `tick` pulse at parameterized rate.  
- `traffic_light_top.v` – Top-level wrapper: instantiates FSM + tick generator.  
- `tb_traffic_light.v` – Testbench (can either generate its own fast tick or test the full top).  

---

## Compilation & Simulation

### Step 1: Compile
```sh
iverilog -o traffic_light_tb tb_traffic_light.v traffic_light.v tick_divider.v traffic_light_top.v
```

### Step 2: Run simulation
```sh
vvp traffic_light_tb
```

This produces a **VCD waveform file** (`traffic_light.vcd`).

### Step 3: View in GTKWave
```sh
gtkwave traffic_light.vcd
```

---

## Expected Behavior

- The FSM cycles as follows (starting with NS green):  
  - **NS Green**: 5 ticks  
  - **NS Yellow**: 2 ticks  
  - **EW Green**: 5 ticks  
  - **EW Yellow**: 2 ticks  
- Lights repeat in a 14-tick cycle.  

Example timeline:  

| Tick | NS | EW |
|------|----|----|
| 0–4  | Green | Red |
| 5–6  | Yellow | Red |
| 7–11 | Red | Green |
| 12–13| Red | Yellow |

---

## Tick Generation

### Hardware (Prescaler)
- System clock: **50 MHz** (20 ns period).  
- Desired tick: **1 Hz** (once per second).  
- Divider count = `CLK_FREQ_HZ / TICK_HZ = 50,000,000 / 1 = 50,000,000`.  
- Counter rolls over every 50 million cycles and asserts `tick` for **1 clock cycle**.  
- Verified in simulation by checking `tick` pulse width = exactly 1 clock cycle.  

### Simulation (Fast Tick)
- Waiting real seconds is impractical.  
- In TB, we generate 1 tick every **20 cycles** (not 50 million).  
- This scales the 5/2/5/2 durations but keeps ratios intact.  
- Example:  
  - NS Green = 5 ticks = 5×20 = 100 cycles.  
  - NS Yellow = 2 ticks = 40 cycles.  
  - EW Green = 5 ticks = 100 cycles.  
  - EW Yellow = 2 ticks = 40 cycles.  
- Verified in GTKWave by observing output changes at expected tick multiples.  

---

## Verification
1. **Tick check**: Confirm `tick` is a 1-cycle pulse (goes high for 1 clk, then low).  
2. **FSM state check**: Count ticks in GTKWave and confirm light durations (5,2,5,2).  
3. **Cycle repetition**: Confirm FSM returns to NS green after 14 ticks.  

---

 With this setup, the FSM is cleanly separated from timing logic, easy to simulate quickly, and hardware-ready with a true 1 Hz tick.
